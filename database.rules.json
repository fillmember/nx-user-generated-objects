{
  "rules": {
    "objects": {
      "$obj_id": {
        ".read": "auth != null",
        "$scene_id": {
          ".read": "auth != null",
          ".write": "newData.exists() || (data.child('user_id').val() == auth.uid)",
          ".validate": "newData.exists() && newData.hasChildren(['user_id','object_id','matrix','timestamp'])",
          "user_id": {
            ".validate": "newData.val() == auth.uid"
          },
          "object_id": {
            ".validate": "newData.isString() && newData.val().length > 0"
          },
          "matrix": {
            ".validate": "newData.isString() && newData.val().length > 0"
          },
          "timestamp": {
            ".validate": "newData.val() < now"
          },
          "$other": {
            ".validate": false
          }
        }
      }
    }
  }
}
